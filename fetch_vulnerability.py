import mysql.connector


def getVulnDetails(vulnerability_name):
    mydb = mysql.connector.connect(
        host = "localhost",
        user = "root",
        passwd = "test1234",
        database = "vulnerabilityreportdb"
    )

    mycursor = mydb.cursor()
    query = "SELECT Vulnerability_Name, Description, CVSS_Score, Severity, Impact, References, Mitigation FROM reports WHERE Vulnerability_Name = %s"
    mycursor.execute(query, (vulnerability_name,))
    row = mycursor.fetchone()
    print(row)

    if row:
        Vulnerability_Name = row[1]
        Description = row[2]
        Severity = row[3]
        Cvss_score = row[4]
        Impact = row[5]
        References = row[6]
        Mitigation = row[7]

        vulnerability_data = {
            "Vulnerability_Name": Vulnerability_Name,
            "URL": url,
            "Description": Description,
            "Cvss_Score": Cvss_score,
            "Severity": Severity,
            "Impact": Impact,
            "References": References,
            "Mitigation": Mitigation,
            "PoC": poc
        }
        
        return vulnerability_data
    else:
        return None